{"title":"快看cms-sql注入审计","uid":"880e1af7df287b27c3dd9350df565202","slug":"快看cms-sql注入审计","date":"2022-11-04T07:47:54.000Z","updated":"2022-11-04T10:58:13.554Z","comments":true,"path":"api/articles/快看cms-sql注入审计.json","keywords":null,"cover":[],"content":"<meta name=\"referrer\" content=\"no-referrer\"/>\n\n<h1 id=\"安装：\"><a href=\"#安装：\" class=\"headerlink\" title=\"安装：\"></a>安装：</h1><p><a href=\"https://github.com/erichuang2015/kkcms\">https://github.com/erichuang2015/kkcms</a></p>\n<p>直接安装 php5.6.9  数据库 kk</p>\n<p>先直接使用Seay扫描，接下来一个一个看扫描结果</p>\n<h1 id=\"sql注入疑似点：\"><a href=\"#sql注入疑似点：\" class=\"headerlink\" title=\"sql注入疑似点：\"></a>sql注入疑似点：</h1><h2 id=\"book-php\"><a href=\"#book-php\" class=\"headerlink\" title=\"book.php\"></a>book.php</h2><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\">&lt;?php \ninclude(&#39;system&#x2F;inc.php&#39;);\nif(isset($_POST[&#39;submit&#39;]))&#123;\n\tif ($_SESSION[&#39;verifycode&#39;] !&#x3D; $_POST[&#39;verifycode&#39;]) &#123;\n\t\talert_href(&#39;验证码错误&#39;,&#39;book.php&#39;);\n\t&#125;\n    null_back($_POST[&#39;userid&#39;],&#39;请填写昵称&#39;);\n\tnull_back($_POST[&#39;content&#39;],&#39;请填写留言内容&#39;);\n\t$data[&#39;userid&#39;] &#x3D; $_POST[&#39;userid&#39;];\n\t$data[&#39;content&#39;] &#x3D;addslashes($_POST[&#39;content&#39;]);\n\t$data[&#39;time&#39;] &#x3D;date(&#39;y-m-d h:i:s&#39;,time());\n\t\n\t$str &#x3D; arrtoinsert($data);\n\t\t$sql &#x3D; &#39;insert into xtcms_book (&#39;.$str[0].&#39;) values (&#39;.$str[1].&#39;)&#39;;\n\t\techo $sql;\n\tif(mysql_query($sql))&#123;\n\nalert_href(&#39;留言成功!小的马上为您准备相关资源！&#39;,&#39;book.php&#39;);\n&#125;\nelse&#123;\nalert_back(&#39;抱歉！服务器好像开小差了呢！&#39;);\n\t&#125;\n\t\n\t\n&#125;\ninclude(&#39;template&#x2F;&#39;.$xtcms_bdyun.&#39;&#x2F;book.php&#39;);\n?&gt;</code></pre>\n\n<p>一处失败sql注入，学习了一下insert注入，也不亏</p>\n<p><strong>insert注入，时间盲注</strong>：<a href=\"https://www.cnblogs.com/lixiongji/p/14035159.html\">https://www.cnblogs.com/lixiongji/p/14035159.html</a></p>\n<p>在book.php留言处，userid看到没有过滤，尝试发现在包含文件的system\\library.php中对get，post，cookie，request都进行了一次addslashes过滤</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\">&lt;?php\n\nif (!defined(&#39;PCFINAL&#39;)) &#123;\n\texit(&#39;Request Error!&#39;);\n&#125;\nif (!get_magic_quotes_gpc()) &#123;\n\tif (!empty($_GET)) &#123;\n\t\t$_GET &#x3D; addslashes_deep($_GET);\n\t&#125;\n\tif (!empty($_POST)) &#123;\n\t\t$_POST &#x3D; addslashes_deep($_POST);\n\t&#125;\n\t$_COOKIE &#x3D; addslashes_deep($_COOKIE);\n\t$_REQUEST &#x3D; addslashes_deep($_REQUEST);\n&#125;\nfunction addslashes_deep($_var_0)\n&#123;\n\tif (empty($_var_0)) &#123;\n\t\treturn $_var_0;\n\t&#125; else &#123;\n\t\treturn is_array($_var_0) ? array_map(&#39;addslashes_deep&#39;, $_var_0) : addslashes($_var_0);\n\t&#125;\n&#125;</code></pre>\n\n<p>在这里存在验证码复用漏洞，用burp发包修改验证码为页面验证码，burp默认不会加载js，就可以重复使用该验证码</p>\n<p>$_session存储在服务器端，$_cookie存储在浏览器</p>\n<p><a href=\"https://www.cnblogs.com/muxiaoye/p/b6f559cf8e9ac31356fe70edab0629b9.html\">https://www.cnblogs.com/muxiaoye/p/b6f559cf8e9ac31356fe70edab0629b9.html</a></p>\n<h2 id=\"addfav-php\"><a href=\"#addfav-php\" class=\"headerlink\" title=\"addfav.php\"></a>addfav.php</h2><p>和前面那个一样</p>\n<h2 id=\"bplay-php-有\"><a href=\"#bplay-php-有\" class=\"headerlink\" title=\"bplay.php  有\"></a>bplay.php  有</h2><p>一样，没想到，这里的id写法有问题，可以直接注入</p>\n<p><a href=\"http://192.168.0.107:8084/bplay.php?play=1\">http://192.168.0.107:8084/bplay.php?play=1</a> and if(1=1,sleep(3),0);#</p>\n<h2 id=\"mpaly-php\"><a href=\"#mpaly-php\" class=\"headerlink\" title=\"mpaly.php\"></a>mpaly.php</h2><p>发现会对$_GET传入的url进行一次base64解码，可能有点希望</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\">if ($_GET[&quot;url&quot;]) &#123;\n    $link &#x3D; base64_decode($_GET[&quot;url&quot;]);</code></pre>\n\n<p>直接先看一种情况，如果有url参数，且$idd==2，将$link赋值给$fang</p>\n<p>之后直接mysql_query()</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\">$result1 &#x3D; mysql_query(&#39;select * from xtcms_vod_class where c_id&#x3D;&#39; . $d_parent . &#39; order by c_id asc&#39;);</code></pre>\n\n<p>这里的$d_parent是哪里来的呢？全局搜索没发现那里定义了，调试发现这个值是未定义，真无语 。可能存在注入，只要可控，毕竟没有引号闭合。</p>\n<h2 id=\"mplayo-php\"><a href=\"#mplayo-php\" class=\"headerlink\" title=\"mplayo.php\"></a>mplayo.php</h2><p>跟前面mplay.php代码一摸一样，这个值也是未定义，直接走，可能是别的文件包含的</p>\n<h2 id=\"youlian-php\"><a href=\"#youlian-php\" class=\"headerlink\" title=\"youlian.php\"></a>youlian.php</h2><p>跟book.php一样</p>\n<h1 id=\"admin后台注入\"><a href=\"#admin后台注入\" class=\"headerlink\" title=\"admin后台注入\"></a>admin后台注入</h1><h2 id=\"admin-cms-backup-php\"><a href=\"#admin-cms-backup-php\" class=\"headerlink\" title=\"admin/cms_backup.php\"></a>admin/cms_backup.php</h2><p>值不可控</p>\n<h2 id=\"admin-cms-zwcs-php\"><a href=\"#admin-cms-zwcs-php\" class=\"headerlink\" title=\"admin/cms_zwcs.php\"></a>admin/cms_zwcs.php</h2><p>经过了过滤</p>\n<h2 id=\"admin-getdata-php-有注入\"><a href=\"#admin-getdata-php-有注入\" class=\"headerlink\" title=\"admin/getdata.php   有注入\"></a>admin/getdata.php   有注入</h2><p>这个可能有点希望，但是这个文件没有包含数据库配置文件</p>\n<p>同时也没有登录验证，可以直接访问</p>\n<p>经过测试，找到了注入点。但是，有个问题，这里没有包括数据库配置文件，sql语句无法执行</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\">&lt;?php\ninclude(&#39;..&#x2F;system&#x2F;inc.php&#39;);  #为了方便验证特意加的\nif (isset($_GET[&#39;play&#39;])) &#123;\n\t$d_parent &#x3D; $_GET[&#39;d_parent&#39;];\n\t$d_player &#x3D; $_GET[&#39;d_player&#39;];\n\t$zhui &#x3D; $_GET[&#39;zhui&#39;];\n\t$player &#x3D; $_GET[&#39;play&#39;];\n\tif ($_GET[&#39;play&#39;] &#x3D;&#x3D; &#39;&#39;) &#123;\n\t\techo &#39;影片不能为空!&#39;;\n\t&#125;\n\t$d_parent &#x3D; $_GET[&#39;d_parent&#39;];\n\t$d_player &#x3D; $_GET[&#39;d_player&#39;];\n\t$zhui &#x3D; $_GET[&#39;zhui&#39;];\n\t$player &#x3D; base64_decode($_GET[&#39;play&#39;]);\n\t$tvinfo &#x3D; file_get_contents($player);\n\t$tvpm &#x3D; &#39;#&lt;h2&gt;(.*?)&lt;&#x2F;h2&gt;#&#39;;\n\t$tvzy &#x3D; &#39;#&lt;li&gt;主演：&lt;span&gt;(.*?)&lt;&#x2F;span&gt;&lt;&#x2F;li&gt;#&#39;;\n\t$tvtp &#x3D; &#39;#&lt;img class&#x3D;&quot;lazy&quot; src&#x3D;&quot;(.*?)&quot; alt&#x3D;&quot;(.*?)&quot; &#x2F;&gt;#&#39;;\n\t$tvzz &#x3D; &#39;#&lt;li&gt;&lt;input type&#x3D;&quot;checkbox&quot; name&#x3D;&quot;copy_sel&quot; value&#x3D;&quot;(.*?)&quot; checked&#x3D;&quot;&quot; &#x2F;&gt;(.*?)&lt;&#x2F;li&gt;#&#39;;\n\t$jianjie &#x3D; &#39;#&lt;div class&#x3D;&quot;vodplayinfo&quot;&gt;(.*?)&lt;&#x2F;div&gt;#&#39;;\n\tpreg_match_all($jianjie, $tvinfo, $jjarr);\n\tpreg_match_all($tvzz, $tvinfo, $tvarr);\n\tpreg_match_all($tvpm, $tvinfo, $btarr);\n\tpreg_match_all($tvzy, $tvinfo, $zyarr);\n\tpreg_match_all($tvtp, $tvinfo, $tparr);\n\t$title &#x3D; $btarr[1];\n\t$tupian &#x3D; $tparr[1];\n\t$zhuyan &#x3D; $zyarr[1];\n\t$dizhi &#x3D; $tvarr[2];\n\t$jj &#x3D; $jjarr[1];\n\t$huiche &#x3D; &#39;\n&#39;;\n\tif (!empty($title)) &#123;\n\t\tforeach ($title as $key &#x3D;&gt; $video) &#123;\n\t\t\t$titile &#x3D; str_replace(&#39;&lt;!--片名开始--&gt;&#39;, &#39;&#39;, &quot;&#123;$title[$key]&#125;&quot;);\n\t\t\t$titile &#x3D; str_replace(&#39;&lt;!--片名结束--&gt;&#39;, &#39;&#39;, &quot;&#123;$titile&#125;&quot;);\n\t\t\t$jieshao &#x3D; str_replace(&#39;&lt;!--介绍开始--&gt;&#39;, &#39;&#39;, &quot;&#123;$jj[$key]&#125;&quot;);\n\t\t\t$jieshao &#x3D; str_replace(&#39;&lt;!--介绍结束--&gt;&#39;, &#39;&#39;, &quot;&#123;$jieshao&#125;&quot;);\n\t\t\t$zyan &#x3D; str_replace(&#39;&lt;!--主演开始--&gt;&#39;, &#39;&#39;, &quot;&#123;$zhuyan[$key]&#125;&quot;);\n\t\t\t$zyan &#x3D; str_replace(&#39;&lt;!--主演结束--&gt;&#39;, &#39;&#39;, &quot;&#123;$zyan&#125;&quot;);\n\t\t\t$pic &#x3D; str_replace(&#39;http:&#x2F;&#x2F;cj.baiwanzy.com&#x2F;LdgImg.php?url&#x3D;&#39;, &#39;&#39;, &quot;&#123;$tupian[$key]&#125;&quot;);\n\t\t\tforeach ($dizhi as $k &#x3D;&gt; $vurl) &#123;\n\t\t\t\tif (strpos($dizhi[$k], &#39;m3u8&#39;)) &#123;\n\t\t\t\t\t$m3u8[] &#x3D; $dizhi[$k] . $huiche;\n\t\t\t\t&#125; elseif (strpos($dizhi[$k], &#39;mp4&#39;)) &#123;\n\t\t\t\t\t$mp4[] &#x3D; $dizhi[$k] . $huiche;\n\t\t\t\t&#125; else &#123;\n\t\t\t\t\t$zhilian[] &#x3D; $dizhi[$k] . $huiche;\n\t\t\t\t&#125;\n\t\t\t&#125;\n\t\t\tif ($zhui &#x3D;&#x3D; 0) &#123;\n\t\t\t\t$_data[&#39;d_scontent&#39;] &#x3D; &#39;&#39; . implode(&#39;&#39;, $zhilian) . &#39;&#39;;\n\t\t\t&#125; elseif ($zhui &#x3D;&#x3D; 1) &#123;\n\t\t\t\t$_data[&#39;d_scontent&#39;] &#x3D; &#39;&#39; . implode(&#39;&#39;, $m3u8) . &#39;&#39;;\n\t\t\t&#125; elseif ($zhui &#x3D;&#x3D; 2) &#123;\n\t\t\t\t$_data[&#39;d_scontent&#39;] &#x3D; &#39;&#39; . implode(&#39;&#39;, $mp4) . &#39;&#39;;\n\t\t\t&#125;\n\t\t\t$_data[&#39;d_player&#39;] &#x3D; $d_player;\n\t\t\t$_data[&#39;d_name&#39;] &#x3D; $titile;\n\t\t\t$_data[&#39;d_zhuyan&#39;] &#x3D; $zyan;\n\t\t\t$_data[&#39;d_picture&#39;] &#x3D; $pic;\n\t\t\t$_data[&#39;d_content&#39;] &#x3D; $jieshao;\n\t\t\t$_data[&#39;d_parent&#39;] &#x3D; $d_parent;\n\t\t\t$str &#x3D; arrtoinsert($_data);\n\t\t\t$result &#x3D; mysql_query(&#39;select * from xtcms_vod where d_name&#x3D; &quot;&#39; . $titile . &#39;&quot;&#39;);\n\t\t\tif (mysql_fetch_array($result)) &#123;\n\t\t\t\t$sql &#x3D; &#39;update xtcms_vod set &#39; . arrtoupdate($_data) . &#39; where d_name&#x3D;&quot;&#39; . $titile . &#39;&quot;&#39;;\n\t\t\t\tif (mysql_query($sql)) &#123;\n\t\t\t\t&#125;\n\t\t\t\techo &#39;&lt;script&gt;alert(&quot;影片重复更新最新地址成功!&quot;);window.opener&#x3D;null;window.close();&lt;&#x2F;script&gt;&#39;;\n\t\t\t&#125; else &#123;\n\t\t\t\t$sql &#x3D; &#39;insert into xtcms_vod (&#39; . $str[0] . &#39;) values (&#39; . $str[1] . &#39;)&#39;;\n\t\t\t\tif (mysql_query($sql)) &#123;\n\t\t\t\t\techo &#39;&lt;script&gt;alert(&quot;影片采集成功!&quot;);window.opener&#x3D;null;window.close();&lt;&#x2F;script&gt;&#39;;\n\t\t\t\t&#125;\n\t\t\t&#125;\n\t\t&#125;\n\t&#125;\n&#125;\nif (isset($_POST[&#39;execute&#39;])) &#123;\n\tnull_back($_POST[&#39;id&#39;], &#39;请至少选中一项！&#39;);\n\t$s &#x3D; &#39;&#39;;\n\t$id &#x3D; &#39;&#39;;\n\tforeach ($_POST[&#39;id&#39;] as $value) &#123;\n\t\t$id .&#x3D; $s . $value;\n\t\t$s &#x3D; &#39;,&#39;;\n\t&#125;\n\tswitch ($_POST[&#39;execute_method&#39;]) &#123;\n\t\tcase &#39;srec&#39;:\n\t\t\t$sql &#x3D; &#39;update xtcms_vod set d_rec &#x3D; 1 where d_id in (&#39; . $id . &#39;)&#39;;\n\t\t\tbreak;\n\t\tcase &#39;crec&#39;:\n\t\t\t$sql &#x3D; &#39;update xtcms_vod set d_rec &#x3D; 0 where d_id in (&#39; . $id . &#39;)&#39;;\n\t\t\tbreak;\n\t\tcase &#39;shot&#39;:\n\t\t\t$sql &#x3D; &#39;update xtcms_vod set d_hot &#x3D; 1 where d_id in (&#39; . $id . &#39;)&#39;;\n\t\t\tbreak;\n\t\tcase &#39;chot&#39;:\n\t\t\t$sql &#x3D; &#39;update xtcms_vod set d_hot &#x3D; 0 where d_id in (&#39; . $id . &#39;)&#39;;\n\t\t\tbreak;\n\t\tcase &#39;delete&#39;:\n\t\t\t$sql &#x3D; &#39;delete from xtcms_vod where d_id in (&#39; . $id . &#39;)&#39;;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\talert_back(&#39;请选择要执行的操作&#39;);\n\t&#125;\n\tmysql_query($sql);\n\talert_href(&#39;执行成功!&#39;, &#39;cms_detail.php?cid&#x3D;0&#39;);\n&#125;\nif (isset($_POST[&#39;shift&#39;])) &#123;\n\tnull_back($_POST[&#39;id&#39;], &#39;请至少选中一项！&#39;);\n\t$s &#x3D; &#39;&#39;;\n\t$id &#x3D; &#39;&#39;;\n\tforeach ($_POST[&#39;id&#39;] as $value) &#123;\n\t\t$id .&#x3D; $s . $value;\n\t\t$s &#x3D; &#39;,&#39;;\n\t&#125;\n\tnull_back($_POST[&#39;shift_target&#39;], &#39;请选择要转移到的频道&#39;);\n\tmysql_query(&#39;update xtcms_vod set d_parent &#x3D; &#39; . $_POST[&#39;shift_target&#39;] . &#39; where d_id in (&#39; . $id . &#39;)&#39;);\n\talert_href(&#39;转移成功!&#39;, &#39;cms_detail.php?cid&#x3D;0&#39;);\n&#125;</code></pre>\n\n<p>简化了一下，其中的include是我后面添加，为了方便验证注入是否成功</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\">&lt;?php\n\ninclude(&#39;system&#x2F;inc.php&#39;);\n$player &#x3D; base64_decode($_GET[&#39;play&#39;]);\n$tvinfo &#x3D; file_get_contents($player);\n&#x2F;&#x2F; $tvinfo &#x3D; &#39;&lt;h2&gt;&lt;!--片名开始--&gt;厉害了，我的国&quot; and if(1&#x3D;1,sleep(3),0);#&lt;!--片名结束--&gt;&lt;&#x2F;h2&gt;&#39;;\n$tvpm &#x3D; &#39;#&lt;h2&gt;(.*?)&lt;&#x2F;h2&gt;#&#39;;\npreg_match_all($tvpm, $tvinfo, $btarr);\n$title &#x3D; $btarr[1];\n\nif (!empty($title)) &#123;\n\tforeach ($title as $key &#x3D;&gt; $video) &#123;\n\t\t$titile &#x3D; str_replace(&#39;&lt;!--片名开始--&gt;&#39;, &#39;&#39;, &quot;&#123;$title[$key]&#125;&quot;);\n\t\t$titile &#x3D; str_replace(&#39;&lt;!--片名结束--&gt;&#39;, &#39;&#39;, &quot;&#123;$titile&#125;&quot;);\n\t\t&#x2F;&#x2F; $jieshao &#x3D; str_replace(&#39;&lt;!--介绍开始--&gt;&#39;, &#39;&#39;, &quot;&#123;$jj[$key]&#125;&quot;);\n\t\t&#x2F;&#x2F; $jieshao &#x3D; str_replace(&#39;&lt;!--介绍结束--&gt;&#39;, &#39;&#39;, &quot;&#123;$jieshao&#125;&quot;);\n\t\t&#x2F;&#x2F; $zyan &#x3D; str_replace(&#39;&lt;!--主演开始--&gt;&#39;, &#39;&#39;, &quot;&#123;$zhuyan[$key]&#125;&quot;);\n\t\t&#x2F;&#x2F; $zyan &#x3D; str_replace(&#39;&lt;!--主演结束--&gt;&#39;, &#39;&#39;, &quot;&#123;$zyan&#125;&quot;);\n\t\t&#x2F;&#x2F; $pic &#x3D; str_replace(&#39;http:&#x2F;&#x2F;cj.baiwanzy.com&#x2F;LdgImg.php?url&#x3D;&#39;, &#39;&#39;, &quot;&#123;$tupian[$key]&#125;&quot;);\n\t\t$result &#x3D; mysql_query(&#39;select * from xtcms_vod where d_name&#x3D; &quot;&#39; . $titile . &#39;&quot;&#39;);\n\t\t&#x2F;&#x2F; var_dump($result);\n\t\t$str&#x3D; &#39;select * from xtcms_vod where d_name&#x3D; &quot;&#39; . $titile . &#39;&quot;&#39;;\n\t\techo $str;\n\t\t&#x2F;&#x2F; $test&#x3D;mysql_query(&#39;select * from xtcms_vod where d_id&#x3D;4 and if(1&#x3D;1,sleep(3),0);#&quot;&#39;);\n\t\t&#x2F;&#x2F; echo $test;\n\t\t&#x2F;&#x2F; if (mysql_fetch_array($test)) &#123;\n\t\t&#x2F;&#x2F; \techo &#39;1111111&#39;;\n\t\t&#x2F;&#x2F; &#125;else&#123;\n\t\t&#x2F;&#x2F; \techo &#39;22222&#39;;\n\t\t&#x2F;&#x2F; &#125;\n\t&#125;\n&#125;\n?&gt;</code></pre>\n\n<p>可以看到，通过get传入一个base64编码的参数play，这个play是一个远程链接，通过file_get_contents或去其中内容，来进行正则匹配，只要链接中的内容为我们构造的payload就能造成注入漏洞</p>\n<p><strong><a href=\"http://ip:xx.txt\">http://ip:xx.txt</a> 内容</strong></p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\">&lt;h2&gt;&lt;!--片名开始--&gt;厉害了，我的国&quot; and if(1&#x3D;1,sleep(3),0);#&lt;!--片名结束--&gt;&lt;&#x2F;h2&gt;</code></pre>\n\n<p>传入?play=base64encode(‘<a href=\"http://ip:xx.txt&#39;)，页面会延时3秒\">http://ip:xx.txt&#39;)，页面会延时3秒</a></p>\n<p>因为这个cms是个采集播放器，所以我开启了远程文件</p>\n<p>传入的是url所以过滤也就没什么用了</p>\n<p>现在就是找到包含了这个文件的文件，其中也包含了数据库配置文件，这样就能正常注入了</p>\n<p>找到了，可惜，只有后台的caijiapi.php</p>\n<h3 id=\"admin-caijiapi-php\"><a href=\"#admin-caijiapi-php\" class=\"headerlink\" title=\"admin/caijiapi.php\"></a>admin/caijiapi.php</h3><p>就看关键，包含了前面的漏洞php，同时也包含了数据库配置</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\">&lt;?php\ninclude(&#39;..&#x2F;system&#x2F;inc.php&#39;);\ninclude(&#39;cms_check.php&#39;);\nerror_reporting(0);\ninclude(&#39;getdata.php&#39;);</code></pre>\n\n<p>同时，也包含了cms_check,php。这不就直接变鸡肋，尝试登录注入一下</p>\n<p>这个验证码能复用，就能爆破了。同时安装时不能设置管理员账号密码，默认管理员账号密码为admin，123456</p>\n<p>注入成功了，前面片名看网站有的片名写上去就行了</p>\n<p><strong>allow_url_fopen 是on才行，这个也是默认开启的吧。</strong></p>\n<p><img src=\"https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/4444/43.png\"></p>\n<p>后面那个switch里面的$id也能注，这个$id直接数字型就ok了</p>\n<h2 id=\"admin-youlian-edit-php-有但是没用\"><a href=\"#admin-youlian-edit-php-有但是没用\" class=\"headerlink\" title=\"admin/youlian_edit.php 有但是没用\"></a>admin/youlian_edit.php 有但是没用</h2><p>这个文件和刚才那个一样，是被包含使用的，通过$_post传参，过滤了</p>\n<p>不过这个id好像有机会</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\">&lt;?php\n\nif (isset($_POST[&#39;save&#39;])) &#123;\n\t$_data[&#39;content&#39;] &#x3D; $_POST[&#39;content&#39;];\n\t$_data[&#39;Reply&#39;] &#x3D; $_POST[&#39;Reply&#39;];\n\t$sql &#x3D; &#39;update xtcms_youlian set &#39; . arrtoupdate($_data) . &#39; where id &#x3D; &#39; . $_GET[&#39;id&#39;] . &#39;&#39;;\n\tif (mysql_query($sql)) &#123;\n\t\talert_href(&#39;修改成功!&#39;, &#39;cms_youlian.php&#39;);\n\t&#125; else &#123;\n\t\talert_back(&#39;修改失败!&#39;);\n\t&#125;\n&#125;</code></pre>\n\n<p>测试一下</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\">&lt;?php\n\ninclude(&#39;system&#x2F;inc.php&#39;);\nif (isset($_POST[&#39;save&#39;])) &#123;\n\t$_data[&#39;content&#39;] &#x3D; $_POST[&#39;content&#39;];\n\t$_data[&#39;Reply&#39;] &#x3D; $_POST[&#39;Reply&#39;];\n\t$sql &#x3D; &#39;update xtcms_youlian set &#39; . arrtoupdate($_data) . &#39; where id &#x3D; &#39; . $_GET[&#39;id&#39;] . &#39;&#39;;\n\techo $sql;\n\n&#125;\n?&gt;</code></pre>\n\n<p><img src=\"https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/4444/42.png\"></p>\n<p>可以的，只要设置了友链，就能通过这个注入，设置一个友链看看效果</p>\n<p>但是。。。。你妹的，没有使用到这个文件，全局搜索发现包含的model/youlian_edit.php</p>\n<p>但是model下没有这个文件，这个不是有什么问题吧。model下只有youlian.php</p>\n<p>反正也是后台，无所谓了</p>\n<h2 id=\"admin-cms-youlian-edit-php\"><a href=\"#admin-cms-youlian-edit-php\" class=\"headerlink\" title=\"admin/cms_youlian_edit.php\"></a>admin/cms_youlian_edit.php</h2><p>这个跟上面那个一样，但是没用</p>\n<h2 id=\"admin-model-link-edit-php-有注入\"><a href=\"#admin-model-link-edit-php-有注入\" class=\"headerlink\" title=\"admin/model/link_edit.php   有注入\"></a>admin/model/link_edit.php   有注入</h2><p>可能是版本切换还是什么，前面两个已经没用了，现在的友链是通过link_edit.php来实现的</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\">&lt;?php\n\nif (isset($_POST[&#39;save&#39;])) &#123;\n\tnull_back($_POST[&#39;l_name&#39;], &#39;请填写链接名称&#39;);\n\tnon_numeric_back($_POST[&#39;l_sort&#39;], &#39;排序必须是数字!&#39;);\n\t$data[&#39;l_name&#39;] &#x3D; $_POST[&#39;l_name&#39;];\n\t$data[&#39;l_logo&#39;] &#x3D; $_POST[&#39;l_logo&#39;];\n\t$data[&#39;l_url&#39;] &#x3D; $_POST[&#39;l_url&#39;];\n\t$data[&#39;l_sort&#39;] &#x3D; $_POST[&#39;l_sort&#39;];\n\t$sql &#x3D; &#39;update xtcms_link set &#39; . arrtoupdate($data) . &#39; where l_id &#x3D; &#39; . $_GET[&#39;l_id&#39;] . &#39;&#39;;\n\tif (mysql_query($sql)) &#123;\n\t\talert_href(&#39;链接修改成功!&#39;, &#39;cms_link.php&#39;);\n\t&#125; else &#123;\n\t\talert_back(&#39;修改失败!&#39;);\n\t&#125;\n&#125;</code></pre>\n\n<p>这个在两个文件中使用到了</p>\n<h3 id=\"admin-cms-link-edit-php\"><a href=\"#admin-cms-link-edit-php\" class=\"headerlink\" title=\"admin/cms_link_edit.php\"></a>admin/cms_link_edit.php</h3><p>这个里面有一句</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\">$result &#x3D; mysql_query(&#39;select * from xtcms_link where l_id &#x3D; &#39;.$_GET[&#39;l_id&#39;].&#39;&#39;);</code></pre>\n\n<p>更简单，直接传入l_id=2 and if(1=1,sleep(3),0) ，就注入了</p>\n<h3 id=\"admin-cms-link-php\"><a href=\"#admin-cms-link-php\" class=\"headerlink\" title=\"admin/cms_link.php\"></a>admin/cms_link.php</h3><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\">&lt;?php\n\t\t\t\t\t\t$result &#x3D; mysql_query(&#39;select * from xtcms_link&#39;);\n\t\t\t\t\t\twhile($row &#x3D; mysql_fetch_array($result))&#123;\n\t\t\t\t\t\t?&gt;\n\t\t\t\t\t\t&lt;tr&gt;\n\t\t\t\t\t\t\t&lt;td&gt;&lt;?php echo $row[&#39;l_sort&#39;]?&gt;&lt;&#x2F;td&gt;\n\t\t\t\t\t\t\t&lt;td&gt;\n\t\t\t\t\t\t\t\t&lt;?php if ($row[&#39;l_logo&#39;] !&#x3D; &#39;&#39;) &#123; ?&gt;\n\t\t\t\t\t\t\t\t&lt;a href&#x3D;&quot;&lt;?php echo $row[&#39;l_logo&#39;]?&gt;&quot; target&#x3D;&quot;_blank&quot;&gt;&lt;img src&#x3D;&quot;&lt;?php echo $row[&#39;l_logo&#39;]?&gt;&quot; width&#x3D;&quot;120&quot; height&#x3D;&quot;30&quot; &#x2F;&gt;&lt;&#x2F;a&gt;\n\t\t\t\t\t\t\t\t&lt;?php &#125; ?&gt;\n\t\t\t\t\t\t\t&lt;&#x2F;td&gt;\n\t\t\t\t\t\t\t&lt;td&gt;&lt;?php echo $row[&#39;l_name&#39;]?&gt;&lt;&#x2F;td&gt;\n\t\t\t\t\t\t\t&lt;td&gt;&lt;?php echo $row[&#39;l_url&#39;]?&gt;&lt;&#x2F;td&gt;\n\t\t\t\t\t\t\t&lt;td&gt;&lt;a class&#x3D;&quot;btn btn-info&quot; href&#x3D;&quot;cms_link_edit.php?l_id&#x3D;&lt;?php echo $row[&#39;l_id&#39;]?&gt;&quot;&gt;&lt;span class&#x3D;&quot;icon-edit&quot;&gt; 修改&lt;&#x2F;span&gt;&lt;&#x2F;a&gt;&amp;nbsp &lt;a class&#x3D;&quot;btn btn-danger&quot; href&#x3D;&quot;cms_link.php?del&#x3D;&lt;?php echo $row[&#39;l_id&#39;]?&gt;&quot; onclick&#x3D;&quot;return confirm(&#39;确认要删除吗？&#39;)&quot;&gt;&lt;span class&#x3D;&quot;icon-times&quot;&gt; 删除&lt;&#x2F;span&gt;&lt;&#x2F;a&gt;&lt;&#x2F;td&gt;\n\t\t\t\t\t\t&lt;&#x2F;tr&gt;</code></pre>\n\n<p>使用语句查询link的结果，这个直接过</p>\n<p>这个文件包含了</p>\n<h4 id=\"admin-model-link-php\"><a href=\"#admin-model-link-php\" class=\"headerlink\" title=\"admin/model/link.php\"></a>admin/model/link.php</h4><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\">&lt;?php\n\nif (isset($_GET[&#39;del&#39;])) &#123;\n\t$sql &#x3D; &#39;delete from xtcms_link where l_id &#x3D; &#39; . $_GET[&#39;del&#39;] . &#39;&#39;;\n\tif (mysql_query($sql)) &#123;\n\t\talert_href(&#39;删除成功!&#39;, &#39;cms_link.php&#39;);\n\t&#125; else &#123;\n\t\talert_back(&#39;删除失败！&#39;);\n\t&#125;\n&#125;\nif (isset($_POST[&#39;save&#39;])) &#123;\n\tnull_back($_POST[&#39;l_name&#39;], &#39;请填写链接名称&#39;);\n\tnon_numeric_back($_POST[&#39;l_sort&#39;], &#39;排序必须是数字!&#39;);\n\t$data[&#39;l_name&#39;] &#x3D; $_POST[&#39;l_name&#39;];\n\t$data[&#39;l_logo&#39;] &#x3D; $_POST[&#39;l_logo&#39;];\n\t$data[&#39;l_url&#39;] &#x3D; $_POST[&#39;l_url&#39;];\n\t$data[&#39;l_sort&#39;] &#x3D; $_POST[&#39;l_sort&#39;];\n\t$str &#x3D; arrtoinsert($data);\n\t$sql &#x3D; &#39;insert into xtcms_link (&#39; . $str[0] . &#39;) values (&#39; . $str[1] . &#39;)&#39;;\n\tif (mysql_query($sql)) &#123;\n\t\t$order &#x3D; mysql_insert_id();\n\t\tif ($_POST[&#39;l_sort&#39;] &#x3D;&#x3D; 0) &#123;\n\t\t\tmysql_query(&#39;update xtcms_link set l_sort &#x3D; &#39; . $order . &#39; where l_id &#x3D; &#39; . $order);\n\t\t&#125;\n\t\talert_href(&#39;链接添加成功!&#39;, &#39;cms_link.php&#39;);\n\t&#125; else &#123;\n\t\talert_back(&#39;添加失败!&#39;);\n\t&#125;\n&#125;</code></pre>\n\n<p>跟前面一样，能够注入，但是用的是delete，直接过</p>\n<h2 id=\"admin-model-ad-php-del\"><a href=\"#admin-model-ad-php-del\" class=\"headerlink\" title=\"admin/model/ad.php del\"></a>admin/model/ad.php del</h2><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\">&lt;?php\n\nif (isset($_GET[&#39;del&#39;])) &#123;\n\t$sql &#x3D; &#39;delete from xtcms_ad where id &#x3D; &#39; . $_GET[&#39;del&#39;] . &#39;&#39;;\n\tif (mysql_query($sql)) &#123;\n\t\talert_href(&#39;删除成功!&#39;, &#39;cms_ad.php&#39;);\n\t&#125; else &#123;\n\t\talert_back(&#39;删除失败！&#39;);\n\t&#125;\n&#125;\nif (isset($_POST[&#39;save&#39;])) &#123;\n\tnull_back($_POST[&#39;title&#39;], &#39;请填写广告名称&#39;);\n\t$data[&#39;title&#39;] &#x3D; $_POST[&#39;title&#39;];\n\t$data[&#39;pic&#39;] &#x3D; $_POST[&#39;pic&#39;];\n\t$data[&#39;catid&#39;] &#x3D; $_POST[&#39;catid&#39;];\n\t$str &#x3D; arrtoinsert($data);\n\t$sql &#x3D; &#39;insert into xtcms_ad (&#39; . $str[0] . &#39;) values (&#39; . $str[1] . &#39;)&#39;;\n\tif (mysql_query($sql)) &#123;\n\t\talert_href(&#39;广告添加成功!&#39;, &#39;cms_ad.php&#39;);\n\t&#125; else &#123;\n\t\talert_back(&#39;添加失败!&#39;);\n\t&#125;\n&#125;\n</code></pre>\n\n<p>delete注入</p>\n<p>后面的insert经过了过滤，无法注入</p>\n<p>在cms_ad.php中使用</p>\n<h3 id=\"cms-ad-php\"><a href=\"#cms-ad-php\" class=\"headerlink\" title=\"cms_ad.php\"></a>cms_ad.php</h3><h2 id=\"ad-edit-php-有\"><a href=\"#ad-edit-php-有\" class=\"headerlink\" title=\"ad_edit.php   有\"></a>ad_edit.php   有</h2><p>这里使用update，并且没有引号，直接注入</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\">&lt;?php\n\nif (isset($_GET[&#39;del&#39;])) &#123;\n\t$sql &#x3D; &#39;delete from xtcms_ad where id &#x3D; &#39; . $_GET[&#39;del&#39;] . &#39;&#39;;\n\tif (mysql_query($sql)) &#123;\n\t\talert_href(&#39;删除成功!&#39;, &#39;cms_ad.php&#39;);\n\t&#125; else &#123;\n\t\talert_back(&#39;删除失败！&#39;);\n\t&#125;\n&#125;\nif (isset($_POST[&#39;save&#39;])) &#123;\n\tnull_back($_POST[&#39;title&#39;], &#39;请填写广告名称&#39;);\n\t$data[&#39;title&#39;] &#x3D; $_POST[&#39;title&#39;];\n\t$data[&#39;pic&#39;] &#x3D; $_POST[&#39;pic&#39;];\n\t$data[&#39;url&#39;] &#x3D; $_POST[&#39;url&#39;];\n\t$data[&#39;catid&#39;] &#x3D; $_POST[&#39;catid&#39;];\n\t$sql &#x3D; &#39;update xtcms_ad set &#39; . arrtoupdate($data) . &#39; where id &#x3D; &#39; . $_GET[&#39;id&#39;] . &#39;&#39;;\n\tif (mysql_query($sql)) &#123;\n\t\talert_href(&#39;广告修改成功!&#39;, &#39;cms_ad.php&#39;);\n\t&#125; else &#123;\n\t\talert_back(&#39;修改失败!&#39;);\n\t&#125;\n&#125;</code></pre>\n\n<p>在cms_ad_edit.php中使用</p>\n<h3 id=\"cms-ad-edit-php\"><a href=\"#cms-ad-edit-php\" class=\"headerlink\" title=\"cms_ad_edit.php\"></a>cms_ad_edit.php</h3><p>直接传参就行了</p>\n<h2 id=\"admin-model-admin-php-del\"><a href=\"#admin-model-admin-php-del\" class=\"headerlink\" title=\"admin\\model\\admin.php   del\"></a>admin\\model\\admin.php   del</h2><p>del有，无用</p>\n<h2 id=\"admin-model-admin-edit-php-有\"><a href=\"#admin-model-admin-edit-php-有\" class=\"headerlink\" title=\"admin\\model\\admin_edit.php  有\"></a>admin\\model\\admin_edit.php  有</h2><p>一样，get传参，在cms_admin_edit.php中使用</p>\n<h2 id=\"admin-model-adwei-php-del\"><a href=\"#admin-model-adwei-php-del\" class=\"headerlink\" title=\"admin\\model\\adwei.php  del\"></a>admin\\model\\adwei.php  del</h2><h2 id=\"admin-model-app-php\"><a href=\"#admin-model-app-php\" class=\"headerlink\" title=\"admin\\model\\app.php\"></a>admin\\model\\app.php</h2><p>无</p>\n<h2 id=\"admin-model-book-php-有\"><a href=\"#admin-model-book-php-有\" class=\"headerlink\" title=\"admin\\model\\book.php  有\"></a>admin\\model\\book.php  有</h2><p>id传参</p>\n<h2 id=\"admin-model-book-edit-php-有\"><a href=\"#admin-model-book-edit-php-有\" class=\"headerlink\" title=\"admin\\model\\book_edit.php  有\"></a>admin\\model\\book_edit.php  有</h2><p>id传参</p>\n<h1 id=\"system\"><a href=\"#system\" class=\"headerlink\" title=\"system\"></a>system</h1><h2 id=\"system-library-php\"><a href=\"#system-library-php\" class=\"headerlink\" title=\"system/library.php\"></a>system/library.php</h2><p>过</p>\n<h2 id=\"system-playurl-php\"><a href=\"#system-playurl-php\" class=\"headerlink\" title=\"system/playurl.php\"></a>system/playurl.php</h2><p>过</p>\n<h2 id=\"system-shoufei-php\"><a href=\"#system-shoufei-php\" class=\"headerlink\" title=\"system/shoufei.php\"></a>system/shoufei.php</h2><p>过</p>\n<h2 id=\"不看后台了，全一样的，全局搜索-GET-‘-传参应该还有一堆，后面只看前台\"><a href=\"#不看后台了，全一样的，全局搜索-GET-‘-传参应该还有一堆，后面只看前台\" class=\"headerlink\" title=\"不看后台了，全一样的，全局搜索  .$_GET[‘   传参应该还有一堆，后面只看前台\"></a>不看后台了，全一样的，全局搜索  .$_GET[‘   传参应该还有一堆，后面只看前台</h2><h1 id=\"template\"><a href=\"#template\" class=\"headerlink\" title=\"template\"></a>template</h1><h2 id=\"template-wapian-vlist-php-有\"><a href=\"#template-wapian-vlist-php-有\" class=\"headerlink\" title=\"template\\wapian\\vlist.php  有\"></a>template\\wapian\\vlist.php  有</h2><p>没有配置文件，找包含的地方</p>\n<h1 id=\"ucenter\"><a href=\"#ucenter\" class=\"headerlink\" title=\"ucenter\"></a>ucenter</h1><p>过</p>\n<h1 id=\"wap\"><a href=\"#wap\" class=\"headerlink\" title=\"wap\"></a>wap</h1><h2 id=\"wap-bplay-有\"><a href=\"#wap-bplay-有\" class=\"headerlink\" title=\"wap\\bplay  有\"></a>wap\\bplay  有</h2><p>一样的直接传入id，同时文件里还有一个漏洞函数，使用这个函数的地方可能存在漏洞</p>\n<h2 id=\"wap-vlist-php-有\"><a href=\"#wap-vlist-php-有\" class=\"headerlink\" title=\"wap\\vlist.php  有\"></a>wap\\vlist.php  有</h2><p>直接传入cid</p>\n<h2 id=\"wap-pay-return-url-shang-php-有\"><a href=\"#wap-pay-return-url-shang-php-有\" class=\"headerlink\" title=\"wap\\pay\\return_url_shang.php  有\"></a>wap\\pay\\return_url_shang.php  有</h2><p>直接传入</p>\n<h2 id=\"wap-pay-return-url-php-有\"><a href=\"#wap-pay-return-url-php-有\" class=\"headerlink\" title=\"wap\\pay\\return_url.php  有\"></a>wap\\pay\\return_url.php  有</h2><p>直接传入</p>\n<h1 id=\"你妹的，后台一堆，前台很多滤了，干\"><a href=\"#你妹的，后台一堆，前台很多滤了，干\" class=\"headerlink\" title=\"你妹的，后台一堆，前台很多滤了，干\"></a>你妹的，后台一堆，前台很多滤了，干</h1><p>看了有正确的写法，将有的值给双引号包裹了，这里参数的id是数字型，作者考虑了可是写法出错了。</p>\n<h1 id=\"被背刺了，没想到一样的模板里还能长出个不一样的花\"><a href=\"#被背刺了，没想到一样的模板里还能长出个不一样的花\" class=\"headerlink\" title=\"被背刺了，没想到一样的模板里还能长出个不一样的花\"></a>被背刺了，没想到一样的模板里还能长出个不一样的花</h1><p>参考链接：<a href=\"https://mp.weixin.qq.com/s/udUKexH8gQsJY9thXJ_smQ\">https://mp.weixin.qq.com/s/udUKexH8gQsJY9thXJ_smQ</a></p>\n<p>在ucenter/reg.php中，有个奇葩操作，在通过<strong>addslashes</strong>过滤了，又使用<strong>stripslashes</strong>除去了转义的<strong>反斜杠</strong>   ！！！！！！！！</p>\n<h2 id=\"ucenter-reg-php\"><a href=\"#ucenter-reg-php\" class=\"headerlink\" title=\"ucenter/reg.php\"></a>ucenter/reg.php</h2><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\">&lt;?php \ninclude(&#39;..&#x2F;system&#x2F;inc.php&#39;);\nif(isset($_SESSION[&#39;user_name&#39;]))&#123;\nheader(&#39;location:index.php&#39;);\n&#125;;\n\t\nif(isset($_POST[&#39;submit&#39;]))&#123;\n$username &#x3D; stripslashes(trim($_POST[&#39;name&#39;]));\n&#x2F;&#x2F; 检测用户名是否存在\n$query &#x3D; mysql_query(&quot;select u_id from xtcms_user where u_name&#x3D;&#39;$username&#39;&quot;);</code></pre>\n\n<p><strong>stripslashes</strong>的作用就是除去不需要使用转义\\，真是奇葩</p>\n<p><strong>剩下就是找用到这个函数的地方，也存在注入，然后就是包含漏洞文件的地方也存在注入</strong></p>\n<h1 id=\"小结：\"><a href=\"#小结：\" class=\"headerlink\" title=\"小结：\"></a>小结：</h1><p>被这一手给惊呆了，以后注意</p>\n<h1 id=\"吐槽：\"><a href=\"#吐槽：\" class=\"headerlink\" title=\"吐槽：\"></a>吐槽：</h1><p><strong>太菜了，只能啃一下老版本的cms，新版的项目有的实在是太大了</strong>，<strong>扫描都有几千个，完全看不过来</strong></p>\n","text":" 安装：https://github.com/erichuang2015/kkcms 直接安装 php5.6.9 数据库 kk 先直接使用Seay扫描，接下来一个一个看扫描结果 sql注入疑似点：book.php&lt;?php include(&#39;system&#x2F;...","link":"","photos":[],"count_time":{"symbolsCount":"19k","symbolsTime":"18 mins."},"categories":[{"name":"代码审计","slug":"代码审计","count":1,"path":"api/categories/代码审计.json"}],"tags":[{"name":"PHP","slug":"PHP","count":2,"path":"api/tags/PHP.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E5%AE%89%E8%A3%85%EF%BC%9A\"><span class=\"toc-text\">安装：</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#sql%E6%B3%A8%E5%85%A5%E7%96%91%E4%BC%BC%E7%82%B9%EF%BC%9A\"><span class=\"toc-text\">sql注入疑似点：</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#book-php\"><span class=\"toc-text\">book.php</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#addfav-php\"><span class=\"toc-text\">addfav.php</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#bplay-php-%E6%9C%89\"><span class=\"toc-text\">bplay.php  有</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#mpaly-php\"><span class=\"toc-text\">mpaly.php</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#mplayo-php\"><span class=\"toc-text\">mplayo.php</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#youlian-php\"><span class=\"toc-text\">youlian.php</span></a></li></ol></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#admin%E5%90%8E%E5%8F%B0%E6%B3%A8%E5%85%A5\"><span class=\"toc-text\">admin后台注入</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#admin-cms-backup-php\"><span class=\"toc-text\">admin&#x2F;cms_backup.php</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#admin-cms-zwcs-php\"><span class=\"toc-text\">admin&#x2F;cms_zwcs.php</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#admin-getdata-php-%E6%9C%89%E6%B3%A8%E5%85%A5\"><span class=\"toc-text\">admin&#x2F;getdata.php   有注入</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#admin-caijiapi-php\"><span class=\"toc-text\">admin&#x2F;caijiapi.php</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#admin-youlian-edit-php-%E6%9C%89%E4%BD%86%E6%98%AF%E6%B2%A1%E7%94%A8\"><span class=\"toc-text\">admin&#x2F;youlian_edit.php 有但是没用</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#admin-cms-youlian-edit-php\"><span class=\"toc-text\">admin&#x2F;cms_youlian_edit.php</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#admin-model-link-edit-php-%E6%9C%89%E6%B3%A8%E5%85%A5\"><span class=\"toc-text\">admin&#x2F;model&#x2F;link_edit.php   有注入</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#admin-cms-link-edit-php\"><span class=\"toc-text\">admin&#x2F;cms_link_edit.php</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#admin-cms-link-php\"><span class=\"toc-text\">admin&#x2F;cms_link.php</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#admin-model-link-php\"><span class=\"toc-text\">admin&#x2F;model&#x2F;link.php</span></a></li></ol></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#admin-model-ad-php-del\"><span class=\"toc-text\">admin&#x2F;model&#x2F;ad.php del</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#cms-ad-php\"><span class=\"toc-text\">cms_ad.php</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#ad-edit-php-%E6%9C%89\"><span class=\"toc-text\">ad_edit.php   有</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#cms-ad-edit-php\"><span class=\"toc-text\">cms_ad_edit.php</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#admin-model-admin-php-del\"><span class=\"toc-text\">admin\\model\\admin.php   del</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#admin-model-admin-edit-php-%E6%9C%89\"><span class=\"toc-text\">admin\\model\\admin_edit.php  有</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#admin-model-adwei-php-del\"><span class=\"toc-text\">admin\\model\\adwei.php  del</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#admin-model-app-php\"><span class=\"toc-text\">admin\\model\\app.php</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#admin-model-book-php-%E6%9C%89\"><span class=\"toc-text\">admin\\model\\book.php  有</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#admin-model-book-edit-php-%E6%9C%89\"><span class=\"toc-text\">admin\\model\\book_edit.php  有</span></a></li></ol></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#system\"><span class=\"toc-text\">system</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#system-library-php\"><span class=\"toc-text\">system&#x2F;library.php</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#system-playurl-php\"><span class=\"toc-text\">system&#x2F;playurl.php</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#system-shoufei-php\"><span class=\"toc-text\">system&#x2F;shoufei.php</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E4%B8%8D%E7%9C%8B%E5%90%8E%E5%8F%B0%E4%BA%86%EF%BC%8C%E5%85%A8%E4%B8%80%E6%A0%B7%E7%9A%84%EF%BC%8C%E5%85%A8%E5%B1%80%E6%90%9C%E7%B4%A2-GET-%E2%80%98-%E4%BC%A0%E5%8F%82%E5%BA%94%E8%AF%A5%E8%BF%98%E6%9C%89%E4%B8%80%E5%A0%86%EF%BC%8C%E5%90%8E%E9%9D%A2%E5%8F%AA%E7%9C%8B%E5%89%8D%E5%8F%B0\"><span class=\"toc-text\">不看后台了，全一样的，全局搜索  .$_GET[‘   传参应该还有一堆，后面只看前台</span></a></li></ol></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#template\"><span class=\"toc-text\">template</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#template-wapian-vlist-php-%E6%9C%89\"><span class=\"toc-text\">template\\wapian\\vlist.php  有</span></a></li></ol></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#ucenter\"><span class=\"toc-text\">ucenter</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#wap\"><span class=\"toc-text\">wap</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#wap-bplay-%E6%9C%89\"><span class=\"toc-text\">wap\\bplay  有</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#wap-vlist-php-%E6%9C%89\"><span class=\"toc-text\">wap\\vlist.php  有</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#wap-pay-return-url-shang-php-%E6%9C%89\"><span class=\"toc-text\">wap\\pay\\return_url_shang.php  有</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#wap-pay-return-url-php-%E6%9C%89\"><span class=\"toc-text\">wap\\pay\\return_url.php  有</span></a></li></ol></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E4%BD%A0%E5%A6%B9%E7%9A%84%EF%BC%8C%E5%90%8E%E5%8F%B0%E4%B8%80%E5%A0%86%EF%BC%8C%E5%89%8D%E5%8F%B0%E5%BE%88%E5%A4%9A%E6%BB%A4%E4%BA%86%EF%BC%8C%E5%B9%B2\"><span class=\"toc-text\">你妹的，后台一堆，前台很多滤了，干</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E8%A2%AB%E8%83%8C%E5%88%BA%E4%BA%86%EF%BC%8C%E6%B2%A1%E6%83%B3%E5%88%B0%E4%B8%80%E6%A0%B7%E7%9A%84%E6%A8%A1%E6%9D%BF%E9%87%8C%E8%BF%98%E8%83%BD%E9%95%BF%E5%87%BA%E4%B8%AA%E4%B8%8D%E4%B8%80%E6%A0%B7%E7%9A%84%E8%8A%B1\"><span class=\"toc-text\">被背刺了，没想到一样的模板里还能长出个不一样的花</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#ucenter-reg-php\"><span class=\"toc-text\">ucenter&#x2F;reg.php</span></a></li></ol></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E5%B0%8F%E7%BB%93%EF%BC%9A\"><span class=\"toc-text\">小结：</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E5%90%90%E6%A7%BD%EF%BC%9A\"><span class=\"toc-text\">吐槽：</span></a></li></ol>","author":{"name":"Longw","slug":"blog-author","avatar":"https://userblink.csdnimg.cn/20211213/qq_57037477/pic/7db9b5c05ba342a75ddf06eecf740949-0.jpg","link":"/","description":"一个不想开挂的安全实习生","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{},"next_post":{"title":"sql-labs-less1-10","uid":"e7ef7d94b3e4c91873147e11ef254294","slug":"sql-labs-less1-10","date":"2022-10-28T11:34:39.000Z","updated":"2022-10-28T11:38:57.497Z","comments":true,"path":"api/articles/sql-labs-less1-10.json","keywords":null,"cover":null,"text":" 什么理解总结都不如做题，做多了就有套路了 答案：https://blog.csdn.net/elephantxiang/article/details/119684515 全程无图less1： id=’$id’ 单引号报错，ordey by 字段为3 union注入需要前面是错...","link":"","photos":[],"count_time":{"symbolsCount":"12k","symbolsTime":"11 mins."},"categories":[{"name":"靶场","slug":"靶场","count":1,"path":"api/categories/靶场.json"}],"tags":[{"name":"sql注入","slug":"sql注入","count":1,"path":"api/tags/sql注入.json"}],"author":{"name":"Longw","slug":"blog-author","avatar":"https://userblink.csdnimg.cn/20211213/qq_57037477/pic/7db9b5c05ba342a75ddf06eecf740949-0.jpg","link":"/","description":"一个不想开挂的安全实习生","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}